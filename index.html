
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KAVISH SHAH | NEON SURFER</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=JetBrains+Mono:wght@400;800&display=swap');
        :root { --neon-blue: #00f2ff; --neon-pink: #ff00ea; --bg: #050508; }
        
        * { box-sizing: border-box; margin: 0; padding: 0; touch-action: none; }
        body { 
            font-family: 'JetBrains Mono', monospace; 
            background: var(--bg); color: #fff; 
            height: 100vh; display: flex; flex-direction: column; align-items: center;
        }

        #gameWrapper {
            margin-top: 8vh;
            width: 90vw;
            max-width: 400px;
            height: 42vh;
            border-left: 2px solid var(--neon-blue);
            border-right: 2px solid var(--neon-blue);
            border-bottom: 2px solid var(--neon-blue);
            position: relative;
            background: #000;
            overflow: hidden;
        }

        canvas { width: 100%; height: 100%; display: block; }

        .score-hud {
            position: absolute; top: 10px; width: 100%;
            display: flex; justify-content: center;
            font-size: 1.1rem; font-weight: 800; color: var(--neon-blue);
            z-index: 10;
        }

        .btn-container {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 15px;
            margin-top: 25px;
            width: 90%;
            max-width: 400px;
        }
        .ctrl-btn {
            height: 75px; background: #111;
            border: 2px solid var(--neon-blue); color: var(--neon-blue);
            border-radius: 12px; font-size: 1.8rem;
            display: flex; align-items: center; justify-content: center;
            user-select: none;
        }
        .jump-btn { border-color: var(--neon-pink); color: var(--neon-pink); font-family: 'Syncopate'; font-size: 0.9rem; }
        .ctrl-btn:active { background: var(--neon-blue); color: #000; }
        .jump-btn:active { background: var(--neon-pink); color: #000; }

        .death-msg {
            position: absolute; inset: 0; background: rgba(0,0,0,0.95);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 100;
        }
    </style>
</head>
<body>

    <h1 style="font-family:'Syncopate'; font-size: 0.7rem; margin-top: 15px; letter-spacing: 5px; color: #444;">DEEP_HORIZON_v3</h1>

    <div id="gameWrapper">
        <div class="score-hud">SCR: <span id="scoreVal">0</span></div>
        <canvas id="gameCanvas"></canvas>
        <div id="deathMsg" class="death-msg">
            <h2 style="color:var(--neon-pink); font-family:'Syncopate';">CRASHED</h2>
            <button onclick="game.init()" style="margin-top:20px; padding:10px 25px; background:none; border:2px solid var(--neon-blue); color:var(--neon-blue); font-family:'Syncopate'; cursor:pointer;">REBOOT</button>
        </div>
    </div>

    <div class="btn-container">
        <div class="ctrl-btn" onpointerdown="game.move(-1)">◀</div>
        <div class="ctrl-btn jump-btn" onpointerdown="game.jump()">JUMP</div>
        <div class="ctrl-btn" onpointerdown="game.move(1)">▶</div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const game = {
            active: false, score: 0, lane: 0,
            obstacles: [], speed: 0.03, // Slightly slower base speed for depth
            yPos: 0, yVel: 0, isJumping: false,

            init() {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
                this.active = true; this.score = 0; this.lane = 0;
                this.obstacles = []; this.speed = 0.03;
                this.yPos = 0; this.yVel = 0; this.isJumping = false;
                document.getElementById('deathMsg').style.display = 'none';
                requestAnimationFrame(() => this.loop());
            },

            move(dir) { 
                this.lane = Math.max(-1, Math.min(1, this.lane + dir)); 
            },
            
            jump() {
                if (!this.isJumping) {
                    this.yVel = 14; 
                    this.isJumping = true;
                }
            },

            loop() {
                if (!this.active) return;
                this.update(); this.draw();
                requestAnimationFrame(() => this.loop());
            },

            update() {
                this.score++;
                document.getElementById('scoreVal').innerText = Math.floor(this.score/10);
                this.speed += 0.00001;

                if (this.isJumping) {
                    this.yPos += this.yVel;
                    this.yVel -= 0.9; 
                    if (this.yPos <= 0) { this.yPos = 0; this.isJumping = false; }
                }

                // Spawning at Z = 5 (Deep Horizon)
                if (Math.random() < 0.06) {
                    this.obstacles.push({ lane: Math.floor(Math.random()*3)-1, z: 5 });
                }

                for (let i = this.obstacles.length - 1; i >= 0; i--) {
                    let o = this.obstacles[i];
                    o.z -= this.speed;

                    // Collision check (Player is at Z ~ 0.5)
                    if (o.z < 0.6 && o.z > 0.3 && o.lane === this.lane) {
                        if (this.yPos < 45) this.gameOver(); 
                    }
                    if (o.z < 0) this.obstacles.splice(i, 1);
                }
            },

            draw() {
                ctx.fillStyle = '#000'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                const cx = canvas.width / 2;
                const horizY = canvas.height * 0.2; // Horizon pushed further up

                // Highlight Current Lane
                ctx.fillStyle = 'rgba(0, 242, 255, 0.08)';
                let hX = cx + (this.lane * (canvas.width * 0.35));
                ctx.beginPath();
                ctx.moveTo(cx, horizY);
                ctx.lineTo(hX - canvas.width*0.25, canvas.height);
                ctx.lineTo(hX + canvas.width*0.25, canvas.height);
                ctx.fill();

                // Floor Grid Lines
                ctx.strokeStyle = '#111';
                for(let i=1; i<15; i++) {
                    let z = (i/15 + (this.score*0.01)%0.06);
                    let y = horizY + (canvas.height-horizY)*z;
                    ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();
                }

                // Lane Guides
                ctx.strokeStyle = '#222';
                [-1.5, -0.5, 0.5, 1.5].forEach(l => {
                    ctx.beginPath();
                    ctx.moveTo(cx, horizY);
                    ctx.lineTo(cx + (l * canvas.width * 1.5), canvas.height);
                    ctx.stroke();
                });

                // Render Obstacles with Scale Factor
                this.obstacles.sort((a,b) => b.z - a.z); // Draw far ones first
                this.obstacles.forEach(o => {
                    let s = 1.5 / o.z; // Perspective multiplier
                    let x = cx + (o.lane) * (canvas.width * 0.5) * s;
                    let y = horizY + (canvas.height - horizY) * s;
                    let sz = (canvas.width * 0.22) * s;
                    
                    // Fade out obstacles on the horizon
                    let opacity = Math.min(1, 1 / o.z);
                    ctx.fillStyle = `rgba(255, 0, 234, ${opacity})`;
                    ctx.shadowBlur = 10*s; ctx.shadowColor = '#ff00ea';
                    ctx.fillRect(x-sz/2, y-sz, sz, sz);
                    ctx.shadowBlur = 0;
                });

                // Player Character
                ctx.fillStyle = '#00f2ff';
                ctx.shadowBlur = 15; ctx.shadowColor = '#00f2ff';
                let pSz = canvas.width * 0.15;
                let charX = cx + (this.lane * (canvas.width * 0.4) * 0.8); // Adjusted X for player perspective
                let charY = (canvas.height * 0.82) - this.yPos;
                ctx.fillRect(charX - pSz/2, charY, pSz, pSz);
            },

            gameOver() { this.active = false; document.getElementById('deathMsg').style.display = 'flex'; }
        };

        game.init();
    </script>
</body>
</html>
